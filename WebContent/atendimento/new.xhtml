<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<ui:composition
	template="/WEB-INF/template/atendimento_template.xhtml">
	<ui:define name="titulo">#{prompt.atendimento}</ui:define>
	<ui:define name="descricao">#{prompt.atendimento_Incluir}</ui:define>
	<ui:define name="descricao_ajuda">#{help.atendimento_Incluir}</ui:define>

	<ui:define name="mensagemSistema" />

	<ui:define name="corpo">

		<a4j:keepAlive beanName="atendimentoActions" />
		<a4j:keepAlive beanName="pacienteActions" />

		<h:form>

			<rich:simpleTogglePanel>
				<f:facet name="header">
					<h:outputText value="#{prompt.atendimento}" />
				</f:facet>

				<h:panelGrid columns="1">
					<f:facet name="header">
						<h:messages globalOnly="true" style="color: red" />
					</f:facet>
				</h:panelGrid>

				<h:panelGrid columns="3">

					<h:panelGroup>
						<h:outputText value="#{prompt.atendimento_Codigo}" />:
			    	</h:panelGroup>

					<h:inputText id="codigo"
						value="#{atendimentoActions.atendimentoCorrente.codAtendimento}"
						maxlength="#{constantes.lAtendimentoCodigo}" size="20"
						required="false" />
					<h:message for="codigo" styleClass="error" />

					<h:panelGroup>
						<h:outputText value="#{prompt.atendimento_Data}" />:
					</h:panelGroup>

					<rich:calendar id="dataAtendimento" datePattern="dd/MM/yyyy HH:mm"
						value="#{atendimentoActions.dataAtendimento}" required="false"
						enableManualInput="false" />
					<h:message for="dataAtendimento" styleClass="error" />


					<h:panelGroup>
						<h:outputText value="#{prompt.medico}" />:
					</h:panelGroup>
					<h:selectOneMenu id="comboMedicos"
						value="#{atendimentoActions.comboMedicos.selecao}"
						disabled="#{atendimentoActions.clinicoEditavel}">
						<f:selectItems
							value="#{atendimentoActions.comboMedicos.listaSelecao}" />
					</h:selectOneMenu>
					<h:message for="comboMedicos" styleClass="error" />

					<h:panelGroup>
						<h:outputText value="#{prompt.tecnico}" />:
					</h:panelGroup>
					<h:selectOneMenu id="comboTecnicos"
						value="#{atendimentoActions.comboTecnicos.selecao}"
						disabled="#{atendimentoActions.tecnicoEditavel}">
						<f:selectItems
							value="#{atendimentoActions.comboTecnicos.listaSelecao}" />
					</h:selectOneMenu>
					<h:message for="comboTecnicos" styleClass="error" />

					<h:panelGroup>
						<h:outputText value="#{prompt.atendimento_Status}" />:
					</h:panelGroup>
					<h:selectOneMenu id="comboStatus"
						value="#{atendimentoActions.comboStatus.selecao}">
						<f:selectItems
							value="#{atendimentoActions.comboStatus.listaSelecao}" />
					</h:selectOneMenu>
					<h:message for="comboStatus" styleClass="error" />

					
					<h:panelGroup>
						<h:outputText value="#{prompt.atendimento_prescricao}" />:
					</h:panelGroup>
					
					<h:inputText id="prescricao"
						value="#{atendimentoActions.atendimentoCorrente.prescricao}"
						maxlength="#{constantes.lAtendimentoPrescricao}" size="100"
						required="false" />
					<h:message for="prescricao" styleClass="error" />
					
					<h:panelGroup>
						<h:outputText value="#{prompt.atendimento_diagnostico}" />:
					</h:panelGroup>
					
					<h:inputText id="diagnostico"
						value="#{atendimentoActions.atendimentoCorrente.diagnostico}"
						maxlength="#{constantes.lAtendimentoDiagnostico}" size="100"
						required="false" />
					<h:message for="diagnostico" styleClass="error" />
					
					<h:panelGroup>
						<h:outputText value="#{prompt.atendimento_observacoes}" />:
					</h:panelGroup>

					<h:inputText id="observacoes"
						value="#{atendimentoActions.atendimentoCorrente.observacoes}"
						maxlength="#{constantes.lAtendimentoObservacoes}" size="100"
						required="false" />
					<h:message for="observacoes" styleClass="error" />
					
				</h:panelGrid>
					
			</rich:simpleTogglePanel>

			<rich:simpleTogglePanel>
				<f:facet name="header">
					<h:outputText value="#{prompt.parametro}" />
				</f:facet>
			
			
			<rich:dataTable id="lista" 
				value="#{atendimentoActions.listaDeAnamneses}" var="anamnese"
				width="470px">
				<f:facet name="header">
					<rich:columnGroup>
						<rich:column >
							<h:outputText title="#{tooltip.parametro}"
								value="#{prompt.parametro_Nome}" />
						</rich:column>
						<rich:column colspan="2">
							<h:outputText title="#{tooltip.parametro_valor}"
								value="#{prompt.parametro_Valor}" />
						</rich:column>
					</rich:columnGroup>
				</f:facet>

				<h:column>
					<h:outputText value="#{anamnese.parametro.nome}" />
				</h:column>

				<rich:column colspan="2">
				
					<h:inputText id="#{anamnese.parametro.nome}_valor"
						value="#{anamnese.valor}"
						required="false" />
					<h:message for="#{anamnese.parametro.nome}_valor" styleClass="error" />
				</rich:column>
						
			</rich:dataTable>
						
									
			</rich:simpleTogglePanel>

			<h:commandButton id="botaoIncluir"
				value="#{prompt.confirmarInclusao}"
				action="#{atendimentoActions.inclui}" />
			<h:commandButton id="botaoVoltar" value="#{prompt.cancelar}"
				action="#{atendimentoActions.cancelar}" immediate="true" />
				
			<rich:panel>
					<f:facet name="header">
						<h:outputText value="#{prompt.atendimento_Historico}"/>
					</f:facet>
	
				<ui:repeat value="#{atendimentoActions.listaDeAtendimentos}" var="atendimento_anterior">
					<rich:simpleTogglePanel opened="false">
						<f:facet name="header">
							<h:outputText value="#{atendimento_anterior.dataAtendimento.time}">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:outputText>
						</f:facet>
		
						<h:panelGrid columns="1">
							<f:facet name="header">
								<h:messages globalOnly="true" style="color: red" />
							</f:facet>
						</h:panelGrid>
		
						<h:panelGrid columns="3">
		
								<h:panelGroup>
									<h:outputText value="#{prompt.atendimento_Data}" />:
									<h:outputText value="#{atendimento_anterior.dataAtendimento.time}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputText>
						    	</h:panelGroup>
							
						</h:panelGrid>
							
					</rich:simpleTogglePanel>
				</ui:repeat>
				
			</rich:panel>
			
		</h:form>
	</ui:define>
</ui:composition>
</html>