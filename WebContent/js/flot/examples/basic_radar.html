<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Flot Examples</title>
    <link href="layout.css" rel="stylesheet" type="text/css"></link>
    <!--[if IE]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="../jquery.js"></script>
    <script language="javascript" type="text/javascript" src="../jquery.flot.js"></script>
    <script language="javascript" text="text/javascript" src="../../JUMFlot/jquery.flot.JUMlib.js"></script>
    <script language="javascript" text="text/javascript" src="../../JUMFlot/jquery.flot.mouse.js"></script>
    <script language="javascript" text="text/javascript" src="../../JUMFlot/jquery.flot.spider.js"></script>

 </head>
    <body>
    <h1>Flot Examples</h1>
    <p id="choices">Show:</p>

    <div id="placeholder" style="width:800px;height:600px;border: 1px dashed gainsboro;"></div>


<script id="source" language="javascript" type="text/javascript">
$(function () {

var plot;

var datasets = {
    "necpac": {
        label: "Necessidade do Paciente",
        data: [ [0,10], [1,20], [2,80], [3,70], [4,60], [5, 40], [6, 90], [7, 10]],
        spider: {show: true, fill: true}
    },     
    "bactrim": {
        label: "Bactrim",
        data: [ [0,30], [1,20], [2,80], [3,70], [4,60], [5, 60], [6, 40], [7, 10] ],
        spider: {show: true}
    },        
    "amox1": {
        label: "Amoxilina 1",
        data: [ [0,20], [1,50], [2,80], [3,50], [4,70], [5, 40], [6, 90], [7, 20] ],
        spider: {show: true}
    },        
};

// var d1 = [ [0,10], [1,20], [2,80], [3,70], [4,60], [5, 40], [6, 90], [7, 10], [8, 60] ];
// var d2= [ [0,30], [1,20], [2,80], [3,70], [4,60], [5, 60], [6, 40], [7, 10], [8, 60] ];
// var d3 = [ [0,20], [1,50], [2,80], [3,50], [4,70], [5, 40], [6, 90], [7, 20], [8, 90] ];

console.log(datasets);
// console.log(d1);
// console.log(d2);
// console.log(d3);


// var data = [
//     { label: "Pies", color:"green",data: d1,
//          spider: {show: true, fill: true} },
//     { label: "Apples",color:"orange",data: d2,
//      spider: {show: true, fill: true} },
//     { label: "Cherries",color:"red",data: d3,
//      spider: {show: true}}   
// ];


var options = {
  series:{ 
    spider:{
      pointSize: 5,
      connection: {width:5},
      active: true, 
      highlight: {
        mode: "area"
      },
      legs: { 
          data: [
            {label: "Efeitos Colaterais"},
            {label: "Febre"},
            {label: "Disuria"},
            {label: "Diabetes"},
            {label: "P005"},
            {label: "P006"},
            {label: "P007"},
            {label: "P008"}
            ],
          // legScaleMax: 1,legScaleMin:0.8
      },
      scaleMode: "static" ,
      legMin: 0,
      legMax: 100,
      spiderSize: 0.5   

    }
  },
    grid:{ 
        hoverable: true, 
        clickable: true,
        tickColor: "rgba(0,0,0,0.2)",mode: "radar"
    }
};

// hard-code color indices to prevent them from shifting as
var i = 0;
$.each(datasets, function(key, val) {
    val.color = i;
    ++i;
});
// insert checkboxes 
var choiceContainer = $("#choices");
$.each(datasets, function(key, val) {
  //adciona todas menos a da necessidade do paciente
  if(key != "necpac"){
    choiceContainer.append('<br/><input type="checkbox" name="' + key +
                           '" id="id' + key + '">' +
                           '<label for="id' + key + '">'
                            + val.label + '</label>');
  }
});

choiceContainer.find("input").click(plotAccordingToChoices);


function plotAccordingToChoices() {
    var data = [];
    //add necessidade do paciente sempre
    data.push(datasets['necpac']);

    choiceContainer.find("input:checked").each(function () {
        var key = $(this).attr("name");
        if (key && datasets[key])
            data.push(datasets[key]);
    });
    console.log(data);
    if (data.length > 0)
      plot = $.plot($("#placeholder"), data, options);
}

plotAccordingToChoices();



$("<div id='tooltip'></div>").css({
  position: "absolute",
  display: "none",
  border: "1px solid #fdd",
  padding: "2px",
  "background-color": "#fee",
  opacity: 0.80
}).appendTo("body");


$("#placeholder").bind("plothover", function (event, pos, item) {
    if (item) {
      var x = item.datapoint[0].toFixed(2),
        y = item.datapoint[1].toFixed(2);
      var label_x = plot.getOptions().series.spider.legs.data[parseInt(x)].label;


      $("#tooltip").html(item.series.label + " of " + label_x + " = " + y)
      // $("#tooltip").offset({left:0,top:0})
        .fadeIn(200);
    } else {
      $("#tooltip").hide();
    }
});


});
</script>

 </body>
</html>
